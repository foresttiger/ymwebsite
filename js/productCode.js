var opt={type:"",value:""};function getCode(a,b,d){switch(a){case"inboundCars":for(var g,f=1;f<=d;f++)g={type:a,title:"\u5165\u5E93\u8F66",value:f+"\u53F7\u8F66"},downloadQRcode(g);break;case"outboundCars":for(var g,f=1;f<=d;f++)g={type:a,title:"\u51FA\u5E93\u8F66",value:f+"\u53F7\u8F66"},downloadQRcode(g);break;case"location":for(var g,f=1;f<=d;f++)g={title:"",type:a,title:"\u533A",value:b+"-"+f},downloadQRcode(g);}}function downloadQRcode(a){var b=a.title+":"+a.value,d={};d[a.type]=a.value,makeCode(d);var e=productQrcodeImg(a);downloadClick(e,b)}function makeCode(a){var b=JSON.stringify(a);$("#qrcode").empty(),$("#qrcode").qrcode({width:400,height:400,colorDark:"#000000",colorLight:"#ffffff",correctLevel:0,text:utf16to8(b)})}function utf16to8(a){var b,d,e,f;for(b="",e=a.length,d=0;d<e;d++)f=a.charCodeAt(d),1<=f&&127>=f?b+=a.charAt(d):2047<f?(b+=String.fromCharCode(224|15&f>>12),b+=String.fromCharCode(128|63&f>>6),b+=String.fromCharCode(128|63&f>>0)):(b+=String.fromCharCode(192|31&f>>6),b+=String.fromCharCode(128|63&f>>0));return b}function productQrcodeImg(a){var b=a.title,d=a.value,e=document.createElement("canvas");e.width=600,e.height=520;var f=e.getContext("2d");f.fillStyle="#ffffff",f.fillRect(0,0,600,500);var g=$("#qrcode canvas")[0],h=document.createElement("canvas");return h.width=440,h.height=520,h.getContext("2d").font="60px Microsoft Yahei",h.getContext("2d").fillStyle="red",h.getContext("2d").drawImage(e,0,0),h.getContext("2d").drawImage(g,20,80),"location"==a.type?h.getContext("2d").fillText(d,160,60):h.getContext("2d").fillText(b+":"+d,30,60),h.toDataURL("image/png")}function downloadClick(a,b){var d=$("<a>"),e=d.attr("href",a).attr("download",b+".png");console.log(e),e[0].click()}function loaderQRcodeImg(a){a.proName+a.componentName;makeCode(a);var e=productQrcodeImg(a);$(".ms .contents .qcode img").attr("src",e)}